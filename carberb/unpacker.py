#! /usr/bin/env python3
from pefile import *
from itertools import cycle

def get_shellcode():
    pe_path = input("Input the path of packed executable: ")
    mystic_offset = input("Input the offset of the encoded mystic code: ")

    xor_key = "\xcb\x81\x3d\x27"
    encrypted_shellcode = []
    with open(pe_path, 'r+b') as file:
        file.seek(mystic_offset)

        while(byte := file.read(1)):
            if(file.tell() == mystic_offset):
                break

            encrypted_shellcode.append(byte)

        return [ bytes([ord(a) ^ ord(b)]) for (a,b) in zip(encrypted_shellcode, xor_key) ]

def main():
        mystic = get_shellcode
        print(mystic)

if __name__ == "__main__":
    main()

